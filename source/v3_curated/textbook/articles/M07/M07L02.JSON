{
  "id": "M07L02",
  "title": "Lehrtext – Grundlagen: Ganzzahlige Modelle II – Branch‑and‑Bound, Relaxation & Schnitte (Gleichungen)",
  "reading_time_min": 92,
  "prerequisites": [
    "M07L01"
  ],
  "outcomes": [
    {
      "level": "Understand",
      "text": "LP‑Relaxation, obere/untere Schranken, Knotenbaum, Fathoming, Branching‑Strategien."
    },
    {
      "level": "Apply",
      "text": "Kleines MILP per Hand skizzieren: Relaxation lösen, verzweigen, Grenzwerte vergleichen."
    },
    {
      "level": "Analyze",
      "text": "Integrality Gap erklären; Gomory‑Schnittidee qualitativ darstellen."
    }
  ],
  "blocks": [
    {
      "type": "introduction",
      "text": "MILPs werden typischerweise mit **Branch‑and‑Bound (B&B)** gelöst, oft ergänzt um **Cuts**.\nWir bauen die Idee Schritt für Schritt und üben an einem kleinen Beispiel."
    },
    {
      "type": "concept",
      "title": "Kernideen",
      "text": "- **LP‑Relaxation**: Ersetze y∈{0,1} durch 0≤y≤1 → liefert **Bound**.  \n- **Branching**: Teile Problem in y=0 und y=1 (oder x≤k, x≥k+1).  \n- **Fathoming**: Zweig verwerfen, wenn unzulässig, Bound schlechter als bestes, oder integrale Lösung gefunden.  \n- **Integrality Gap**: Differenz Relaxation vs. optimale integrale Lösung.",
      "explanation": "\n\n**Decision-Hints:**\n- Lineare Gleichungen isolieren: gleiche Operation auf beiden Seiten.\n- Klammern zuerst auflösen, dann nach x umstellen."
    },
    {
      "type": "visual",
      "title": "ASCII – B&B‑Baum",
      "ascii": "(Root, LP-Bound)\n      /            \\\n   y=0            y=1\n  /   \\          /   \\\n...  (int)    (infeas) ...",
      "caption": "Zweige sterben (fathom), wenn integrale Lösung oder Bound schlechter.",
      "alt_text": "ASCII-Visual: Zweige sterben (fathom), wenn integrale Lösung oder Bound schlechter. — Achsen x/y, Einheiten und Legende beachten."
    },
    {
      "type": "example",
      "subtype": "worked",
      "title": "Worked – Mini‑Rucksack per B&B (Skizze)",
      "text": "3 Projekte: DB=[50,40,35], Kosten=[4,3,3], Budget B=6. y∈{0,1}.  \nLP‑Relaxation erlaubt Bruchteile. Root‑LP wählt y₁=1 (4), y₂=1 (3) → Budget 7 > 6 → fraktionale Lösung: y₁=1, y₂=2/3, z=50+40·2/3≈76,7.  \nBranch auf y₂: Fall A y₂=1 ⇒ Budget 7>6 → unzulässig; Fall B y₂=0 ⇒ übrig 2 für y₃ (3) → y₃=0; Lösung y₁=1, z=50 (Bound verbessert sich weiter mit anderen Branches).  \nÜbung: vollständigen Baum skizzieren und bestes integrales Muster bestimmen (z. B. y₂=1, y₃=1 nicht zulässig).",
      "steps": [
        "Projekte: DB=[50,40,35], Kosten=[4,3,3], Budget B=6. y∈{0,1}",
        "LP‑Relaxation erlaubt Bruchteile. Root‑LP wählt y₁=1 (4), y₂=1 (3) → Budget 7 > 6 → fraktionale Lösung: y₁=1, y₂=2/3, z=50+40·2/3≈76,",
        "Branch auf y₂: Fall A y₂=1 → Budget 7>6 → unzulässig; Fall B y₂=0 → übrig 2 für y₃ (3) → y₃=0; Lösung y₁=1, z=50 (Bound verbessert sich weiter mit anderen Branches",
        "Übung: vollständigen Baum skizzieren und bestes integrales Muster bestimmen (z. B. y₂=1, y₃=1 nicht zulässig"
      ]
    },
    {
      "type": "example",
      "subtype": "fading",
      "title": "Fading – Bound‑Vergleich",
      "text": "Du hast bestes integral z*=75. Ein Zweig hat LP‑Bound 74,5. Was tust du? Und bei LP‑Bound 80?",
      "solution": [
        "74,5 < 75 → Zweig fathomen (dominanz).",
        "80 ≥ 75 → weiter verzweigen (Potenzial)."
      ],
      "steps": [
        "Du hast bestes integral z*=75.",
        "Ein Zweig hat LP‑Bound 74,5.",
        "Was tust du?",
        "Und bei LP‑Bound 80?"
      ]
    },
    {
      "type": "exercises",
      "mini": [
        {
          "prompt": "LP‑Relaxation liefert bei Maximierung…",
          "hint": "obere Schranke",
          "solution": "Bound",
          "check": {
            "type": "string_contains",
            "expected": "Schranke"
          },
          "difficulty": "leicht"
        },
        {
          "prompt": "Fathoming‑Kriterium NICHT?",
          "hint": "‚Bound besser als bestes‘",
          "solution": "falsch – dann **kein** Fathoming",
          "check": {
            "type": "string_contains",
            "expected": "falsch"
          },
          "difficulty": "leicht"
        },
        {
          "prompt": "Integrality Gap klein bedeutet…",
          "hint": "Relaxation ist stark",
          "solution": "gut",
          "check": {
            "type": "string_contains",
            "expected": "stark"
          },
          "difficulty": "leicht"
        },
        {
          "prompt": "Nenne den Grundsatz zum Lösen linearer Gleichungen (Textantwort).",
          "solution": "Äquivalenzumformungen: gleiche Operation auf beiden Seiten",
          "check": {
            "type": "string_contains",
            "expected": "Operation"
          },
          "covers_outcomes": [
            0
          ],
          "difficulty": "leicht"
        },
        {
          "prompt": "Nenne den Grundsatz zum Lösen linearer Gleichungen (Textantwort).",
          "solution": "Äquivalenzumformungen: gleiche Operation auf beiden Seiten",
          "check": {
            "type": "string_contains",
            "expected": "Operation"
          },
          "covers_outcomes": [
            1
          ],
          "difficulty": "leicht"
        },
        {
          "prompt": "Nenne den Grundsatz zum Lösen linearer Gleichungen (Textantwort).",
          "solution": "Äquivalenzumformungen: gleiche Operation auf beiden Seiten",
          "check": {
            "type": "string_contains",
            "expected": "Operation"
          },
          "covers_outcomes": [
            2
          ],
          "difficulty": "leicht"
        }
      ],
      "long": [
        {
          "title": "Praxis – B&B‑Skizze für CAPEX‑Auswahl",
          "context": "DB=[70,55,50,35], Kosten=[5,4,4,2], Budget 8. Führe 2 Branch‑Ebenen durch und dokumentiere Bounds & beste Lösung.",
          "subtasks": [
            {
              "text": "Root‑LP lösen (fraktional)."
            },
            {
              "text": "Branch auf vielversprechende Variable."
            },
            {
              "text": "Boundvergleich & Fathoming dokumentieren."
            }
          ],
          "hints": [
            "Greedy liefert Startlösung als Untergrenze.",
            "Wähle Variable mit fraktionalstem Wert.",
            "Protokolliere Baum."
          ],
          "solutions": [
            "Baum gezeichnet",
            "Bestwert dokumentiert",
            "Fathoming korrekt"
          ],
          "checks": [
            {
              "type": "free_form",
              "keywords": [
                "Bound",
                "Branch",
                "Fraktional"
              ]
            }
          ],
          "difficulty": "leicht",
          "steps": [
            "Baum gezeichnet",
            "Bestwert dokumentiert",
            "Fathoming korrekt"
          ]
        }
      ]
    },
    {
      "type": "common_mistakes",
      "items": [
        "Bound‑Logik verwechselt (max vs. min).",
        "Fraktionale Relaxationswerte direkt als integer interpretiert.",
        "Ohne Startheuristik begonnen → schwache initiale Untergrenze."
      ]
    },
    {
      "type": "quiz",
      "items": [
        {
          "type": "single_choice",
          "question": "LP‑Relaxation in Max‑Problemen ist…",
          "options": [
            "untere Schranke",
            "obere Schranke",
            "keine Schranke"
          ],
          "answer_index": 1,
          "rationale": "z_LP ≥ z_int.",
          "difficulty": "leicht",
          "feedback_correct": "Richtig. z_LP ≥ z_int.",
          "feedback_incorrect": "Beachte: Äquivalenzumformungen: gleiche Operation beidseitig; Punkt-vor-Strich beachten."
        },
        {
          "type": "true_false",
          "question": "Ein integrales LP‑Optimum am Root beendet die Suche sofort.",
          "answer": true,
          "rationale": "Keine Branches nötig.",
          "difficulty": "leicht",
          "feedback_correct": "Richtig. Keine Branches nötig.",
          "feedback_incorrect": "Beachte: Äquivalenzumformungen: gleiche Operation beidseitig; Punkt-vor-Strich beachten."
        },
        {
          "type": "single_choice",
          "question": "Gomory‑Schnittidee:",
          "options": [
            "Neue Variable einführen",
            "Unganzzahligkeit durch lineare Ungleichung ausschließen",
            "Ziel skalieren"
          ],
          "answer_index": 1,
          "rationale": "Cutting Plane.",
          "difficulty": "leicht",
          "feedback_correct": "Richtig. Cutting Plane.",
          "feedback_incorrect": "Beachte: Äquivalenzumformungen: gleiche Operation beidseitig; Punkt-vor-Strich beachten."
        },
        {
          "type": "true_false",
          "question": "Lineare Gleichungen löst man durch dieselbe Operation auf beiden Seiten.",
          "answer": true,
          "rationale": "Äquivalenzumformungen: gleicher Schritt links und rechts.",
          "covers_outcomes": [
            0
          ],
          "difficulty": "leicht",
          "feedback_correct": "Richtig. Äquivalenzumformungen: gleicher Schritt links und rechts.",
          "feedback_incorrect": "Beachte: Äquivalenzumformungen: gleiche Operation beidseitig; Punkt-vor-Strich beachten."
        },
        {
          "type": "true_false",
          "question": "Beim Umstellen kommt die Punkt-vor-Strich-Regel nicht zum Tragen.",
          "answer": false,
          "rationale": "Zuerst Klammern auflösen, Punkt-vor-Strich beachten.",
          "covers_outcomes": [
            1
          ],
          "difficulty": "leicht",
          "feedback_correct": "Richtig. Zuerst Klammern auflösen, Punkt-vor-Strich beachten.",
          "feedback_incorrect": "Beachte: Äquivalenzumformungen: gleiche Operation beidseitig; Punkt-vor-Strich beachten."
        },
        {
          "type": "true_false",
          "question": "Lineare Gleichungen löst man durch dieselbe Operation auf beiden Seiten.",
          "answer": true,
          "rationale": "Äquivalenzumformungen: gleicher Schritt links und rechts.",
          "covers_outcomes": [
            2
          ],
          "difficulty": "leicht",
          "feedback_correct": "Richtig. Äquivalenzumformungen: gleicher Schritt links und rechts.",
          "feedback_incorrect": "Beachte: Äquivalenzumformungen: gleiche Operation beidseitig; Punkt-vor-Strich beachten."
        }
      ]
    },
    {
      "type": "summary",
      "text": "Du skizzierst B&B, setzt Bounds korrekt ein und verstehst die Idee von Schnitten und Integrality Gap."
    },
    {
      "type": "outlook",
      "text": "Als Nächstes: **Klassiker** (Rucksack, Set Cover, Standort) und **heuristische** Lösungsstrategien."
    }
  ],
  "reading_time_band": "gründlich"
}
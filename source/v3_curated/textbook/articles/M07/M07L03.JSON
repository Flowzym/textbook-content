{
  "id": "M07L03",
  "title": "Lehrtext – Grundlagen: Klassische MILP‑Probleme – Rucksack, Set Cover, Standort & Budgetierung (Break-even)",
  "reading_time_min": 96,
  "prerequisites": [
    "M07L02"
  ],
  "outcomes": [
    {
      "level": "Understand",
      "text": "Problemklassen und typische Modellierungen (Indices, Nebenbedingungen)."
    },
    {
      "level": "Apply",
      "text": "Rucksack (0/1), Set‑Cover/Personalplanung, Standort (Facility Location) modellieren."
    },
    {
      "level": "Analyze",
      "text": "Greedy/DP‑Heuristiken für Rucksack vergleichen; Aufwands‑/Qualitätstrade‑offs bewerten."
    }
  ],
  "blocks": [
    {
      "type": "introduction",
      "text": "Wir bündeln Standardfälle aus Controlling/Operations: Portfolio‑Budgetierung, Personalabdeckung, Standortwahl."
    },
    {
      "type": "concept",
      "title": "Modellschablonen",
      "text": "- **0/1‑Rucksack**: max Σ v_i y_i s.t. Σ w_i y_i ≤ B; y_i∈{0,1}.  \n- **Set Cover**: min Σ c_j y_j s.t. Σ_{j: j deckt i} y_j ≥ 1 ∀i; y_j∈{0,1}.  \n- **Standort (Uncapacitated Facility Location)**: min Σ f_j y_j + Σ c_{i,j} x_{i,j} s.t. Σ_j x_{i,j}=d_i, x_{i,j} ≤ M·y_j.",
      "explanation": "\n\n**Decision-Hints:**\n- Break-even, wenn Gewinn=0: x_BE = K_fix/(p−k_v).\n- Zielgewinn mit (K_fix+G)/(p−k_v) berechnen."
    },
    {
      "type": "visual",
      "title": "ASCII – Set‑Cover",
      "ascii": "Aufgaben i=1..m  ◄──  Ressourcen j=1..n\n  jeder i muss von ≥1 j 'gedeckt' sein",
      "caption": "Deckungsnebenbedingungen sichern Mindestabdeckung.",
      "alt_text": "ASCII-Visual: Deckungsnebenbedingungen sichern Mindestabdeckung. — Achsen x/y, Einheiten und Legende beachten."
    },
    {
      "type": "example",
      "subtype": "worked",
      "title": "Worked – Budgetierung (Rucksack) mit Pflichtprojekt",
      "text": "Pflichtprojekt P hat y_P=1, Budget B. Alle anderen optional.  \nModell erweitern: y_P=1; Budget: K_P + Σ K_i y_i ≤ B.  \n**Tipp**: Pflicht‑/Ausschluss‑Projekte lassen sich direkt durch y=1/y=0 setzen.",
      "steps": [
        "Pflichtprojekt P hat y_P=1, Budget B. Alle anderen optional",
        "Modell erweitern: y_P=1; Budget: K_P + Σ K_i y_i ≤ B",
        "Tipp**: Pflicht‑/Ausschluss‑Projekte lassen sich direkt durch y=1/y=0 setzen"
      ]
    },
    {
      "type": "example",
      "subtype": "worked",
      "title": "Worked – Standortwahl (UFL)",
      "text": "Nachfrage d_i, Fixkosten f_j, Transportkosten c_{i,j}.  \nmin Σ f_j y_j + Σ c_{i,j} x_{i,j};  Σ_j x_{i,j}=d_i;  x_{i,j} ≤ M·y_j.  \n**Interpretation**: Öffne nur Standorte mit y_j=1; Kunden werden zu geöffneten Standorten zugewiesen.",
      "steps": [
        "Nachfrage d_i, Fixkosten f_j, Transportkosten c_{i,j}",
        "min Σ f_j y_j + Σ c_{i,j} x_{i,j};  Σ_j x_{i,j}=d_i;  x_{i,j} ≤ M·y_j",
        "Interpretation**: Öffne nur Standorte mit y_j=1; Kunden werden zu geöffneten Standorten zugewiesen"
      ]
    },
    {
      "type": "example",
      "subtype": "fading",
      "title": "Fading – Set Cover für Mindestbesetzung",
      "text": "Schichten j decken Stunden i (Matrix A_{i,j}∈{0,1}).  \nZielfunktion: min Σ Kosten_j y_j; Nebenbed.: Σ_j A_{i,j} y_j ≥ 1 ∀i.  \na) Woher kommt A_{i,j}? b) Wie erweiterst du auf ‚≥2‘ Deckungen?",
      "solution": [
        "A aus Einsatzplan/Qualifikation.",
        "Σ_j A_{i,j} y_j ≥ 2."
      ],
      "steps": [
        "Schichten j decken Stunden i (Matrix A_{i,j}∈{0,1}",
        "Zielfunktion: min Σ Kosten_j y_j; Nebenbed.: Σ_j A_{i,j} y_j ≥ 1 ∀i",
        "a) Woher kommt A_{i,j}? b) Wie erweiterst du auf ‚≥2‘ Deckungen?"
      ]
    },
    {
      "type": "exercises",
      "mini": [
        {
          "prompt": "Rucksack‑Dominanztest: Wenn w_i≤w_k und v_i≥v_k…",
          "hint": "k dominiert, i bevorzugen",
          "solution": "Dominanzregel",
          "check": {
            "type": "string_contains",
            "expected": "dominiert"
          },
          "difficulty": "leicht"
        },
        {
          "prompt": "Set Cover: harte vs. weiche Deckung?",
          "hint": "≥1 vs. Strafkosten",
          "solution": "Weiche als Penalties",
          "check": {
            "type": "string_contains",
            "expected": "Straf"
          },
          "difficulty": "leicht"
        },
        {
          "prompt": "UFL: Kopplung x_{i,j}…",
          "hint": "x_{i,j} ≤ M·y_j",
          "solution": "Korrekt",
          "check": {
            "type": "string_contains",
            "expected": "≤"
          },
          "difficulty": "leicht"
        },
        {
          "prompt": "Gib die Break-Even- bzw. Zielgewinnformel an (Textantwort).",
          "solution": "x_BE=K_fix/(p−k_v) bzw. x=(K_fix+G)/(p−k_v)",
          "check": {
            "type": "string_contains",
            "expected": "p−k_v"
          },
          "covers_outcomes": [
            0
          ],
          "difficulty": "mittel"
        },
        {
          "prompt": "Gib die Break-Even- bzw. Zielgewinnformel an (Textantwort).",
          "solution": "x_BE=K_fix/(p−k_v) bzw. x=(K_fix+G)/(p−k_v)",
          "check": {
            "type": "string_contains",
            "expected": "p−k_v"
          },
          "covers_outcomes": [
            1
          ],
          "difficulty": "mittel"
        },
        {
          "prompt": "Gib die Break-Even- bzw. Zielgewinnformel an (Textantwort).",
          "solution": "x_BE=K_fix/(p−k_v) bzw. x=(K_fix+G)/(p−k_v)",
          "check": {
            "type": "string_contains",
            "expected": "p−k_v"
          },
          "covers_outcomes": [
            2
          ],
          "difficulty": "mittel"
        }
      ],
      "long": [
        {
          "title": "Praxis – Standort & Budget",
          "context": "Wähle Standorte (Fixkosten) und weise Kunden zu (Transportkosten). Budgetgrenze F_max für Fixkosten.",
          "subtasks": [
            {
              "text": "Formuliere UFL + Σ f_j y_j ≤ F_max."
            },
            {
              "text": "Diskutiere Big‑M vs. stärkere Ungleichungen."
            },
            {
              "text": "Zeige, wie eine Mindestanzahl Standorte erzwungen wird."
            }
          ],
          "hints": [
            "x≤M y; Σ y_j ≥ k.",
            "Stärkere Schranken: Nachfrageobergrenzen pro Standort.",
            "Σ y_j ≥ k als Nebenbed."
          ],
          "solutions": [
            "Modell vollständig",
            "Stärkere Cuts genannt",
            "k‑Constraint gesetzt"
          ],
          "checks": [
            {
              "type": "free_form",
              "keywords": [
                "UFL",
                "Budget",
                "k-Standorte"
              ]
            }
          ],
          "difficulty": "leicht",
          "steps": [
            "Modell vollständig",
            "Stärkere Cuts genannt",
            "k‑Constraint gesetzt"
          ]
        }
      ]
    },
    {
      "type": "common_mistakes",
      "items": [
        "Zu großes M im UFL → schwache Relaxation.",
        "Set‑Cover‑Matrix falsch (Zeilen/Spalten vertauscht).",
        "Dominanz/Preprocessing nicht genutzt → unnötig große Modelle."
      ]
    },
    {
      "type": "quiz",
      "items": [
        {
          "type": "single_choice",
          "question": "Set Cover Zielfunktion ist typ. …",
          "options": [
            "Kostenminimierung",
            "Gewinnmaximierung",
            "Zufallswahl"
          ],
          "answer_index": 0,
          "rationale": "Minimieren.",
          "difficulty": "leicht",
          "feedback_correct": "Richtig. Minimieren.",
          "feedback_incorrect": "Beachte: x_BE=K_fix/(p−k_v); Zielgewinn x=(K_fix+G)/(p−k_v)."
        },
        {
          "type": "true_false",
          "question": "UFL benötigt Binärvariablen für Standortöffnung.",
          "answer": true,
          "rationale": "y_j∈{0,1}.",
          "difficulty": "leicht",
          "feedback_correct": "Richtig. y_j∈{0,1}.",
          "feedback_incorrect": "Beachte: x_BE=K_fix/(p−k_v); Zielgewinn x=(K_fix+G)/(p−k_v)."
        },
        {
          "type": "single_choice",
          "question": "Rucksack‑Heuristik:",
          "options": [
            "Greedy nach v/w‑Quote",
            "zufällige Wahl",
            "immer DP"
          ],
          "answer_index": 0,
          "rationale": "Bewährter Start.",
          "difficulty": "leicht",
          "feedback_correct": "Richtig. Bewährter Start.",
          "feedback_incorrect": "Beachte: x_BE=K_fix/(p−k_v); Zielgewinn x=(K_fix+G)/(p−k_v)."
        },
        {
          "type": "true_false",
          "question": "Die Break-Even-Menge lautet K_fix/(p−k_v).",
          "answer": true,
          "rationale": "Verlustschwelle: Fixkosten durch Stückdeckungsbeitrag p−k_v.",
          "covers_outcomes": [
            0
          ],
          "difficulty": "mittel",
          "feedback_correct": "Richtig. Verlustschwelle: Fixkosten durch Stückdeckungsbeitrag p−k_v.",
          "feedback_incorrect": "Beachte: x_BE=K_fix/(p−k_v); Zielgewinn x=(K_fix+G)/(p−k_v)."
        },
        {
          "type": "true_false",
          "question": "Für den Zielgewinn gilt x=(K_fix−G)/(p−k_v).",
          "answer": false,
          "rationale": "Richtig: x=(K_fix+G)/(p−k_v).",
          "covers_outcomes": [
            1
          ],
          "difficulty": "mittel",
          "feedback_correct": "Richtig. Richtig: x=(K_fix+G)/(p−k_v).",
          "feedback_incorrect": "Beachte: x_BE=K_fix/(p−k_v); Zielgewinn x=(K_fix+G)/(p−k_v)."
        },
        {
          "type": "true_false",
          "question": "Die Break-Even-Menge lautet K_fix/(p−k_v).",
          "answer": true,
          "rationale": "Verlustschwelle: Fixkosten durch Stückdeckungsbeitrag p−k_v.",
          "covers_outcomes": [
            2
          ],
          "difficulty": "mittel",
          "feedback_correct": "Richtig. Verlustschwelle: Fixkosten durch Stückdeckungsbeitrag p−k_v.",
          "feedback_incorrect": "Beachte: x_BE=K_fix/(p−k_v); Zielgewinn x=(K_fix+G)/(p−k_v)."
        }
      ]
    },
    {
      "type": "summary",
      "text": "Du modellierst Rucksack, Set Cover und Standortwahl und kennst Greedy/DP‑Heuristiken als Werkzeuge."
    },
    {
      "type": "outlook",
      "text": "Zum Abschluss: **Heuristiken & Metaheuristiken** für große Instanzen – konstruktion & Verbesserung."
    }
  ],
  "reading_time_band": "gründlich"
}
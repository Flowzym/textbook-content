{
  "id": "M08L04",
  "title": "Lehrtext – Grundlagen: Zeitreihen IV – Praxisfälle: Nachfrage, Budget, Bestände & Forecast‑Kombinationen (Statistik)",
  "reading_time_min": 102,
  "prerequisites": [
    "M08L03"
  ],
  "outcomes": [
    {
      "level": "Apply",
      "text": "Forecasts in Entscheidungsgrößen überführen (Budget, Beschaffung, Bestände)."
    },
    {
      "level": "Analyze",
      "text": "Sicherheitsbestand aus Prognosefehlern ableiten; Hierarchische Forecasts und Kombinationen einsetzen."
    },
    {
      "level": "Evaluate",
      "text": "Modellauswahl & Governance (Freeze‑Fenster, Overrides, Tracking‑Signal) begründen."
    }
  ],
  "blocks": [
    {
      "type": "introduction",
      "text": "Wir schließen mit typischen **Controlling/SCM‑Anwendungen**: Nachfrage‑Forecasts, Budgetrollierung,\nSicherheitsbestände, **Forecast‑Kombinationen** und **Hierarchien** (z. B. Produkt→Kategorie→Gesamt)."
    },
    {
      "type": "concept",
      "title": "Vom Forecast zur Entscheidung",
      "text": "- **Budget**: Forecast ̂y → Erlöse/Kosten planen; Unsicherheit via Szenarien/Intervalle.  \n- **Beschaffung/Bestand**: **Sicherheitsbestand** SS = z·σ_L (z-Servicefaktor; σ_L Prognosefehler im Lead‑Time‑Horizon).  \n- **Tracking‑Signal**: kumulierter Fehler / MAD – Bias‑Überwachung.  \n- **Hierarchische Forecasts**: Bottom‑up, Top‑down, Middle‑out; **Reconciliation** sorgt für Konsistenz.  \n- **Kombinationen**: ̂y_comb = Σ w_i ̂y^{(i)}, Gewichte z. B. nach inverser Fehlerquote.",
      "explanation": "\n\n**Decision-Hints:**\n- Lageparameter wählen: Mittelwert robust? → ggf. Median nutzen.\n- Streuung: Varianz in Einheiten^2, Standardabweichung in Einheiten."
    },
    {
      "type": "visual",
      "title": "ASCII – Hierarchische Forecasts",
      "ascii": "Gesamt\n    /  |   \\\n  CatA CatB CatC\n  / \\         \\\nSKU SKU       SKU",
      "caption": "Forecasts auf SKU‑Ebene konsistent zur Kategorie und zum Gesamt machen (Reconciliation).",
      "alt_text": "ASCII-Visual: Forecasts auf SKU‑Ebene konsistent zur Kategorie und zum Gesamt machen (Reconciliation). — Achsen x/y, Einheiten und Legende beachten."
    },
    {
      "type": "example",
      "subtype": "worked",
      "title": "Worked – Sicherheitsbestand aus RMSE",
      "text": "Lead Time L=2 Monate. RMSE im 1‑Schritt‑Backtest = 120 Einheiten (≈σ). Service 95% → z≈1,65.  \nSS ≈ z·σ·√L = 1,65 · 120 · √2 ≈ **280** Einheiten.  \n**Interpretation**: So viel Extra‑Bestand, um 95% der Nachfrageschwankungen im L‑Horizont zu puffern.",
      "steps": [
        "Lead Time L=2 Monate. RMSE im 1‑Schritt‑Backtest = 120 Einheiten (≈σ). Service 95% → z≈1,",
        "SS ≈ z·σ·√L = 1,65 · 120 · √2 ≈ **280** Einheiten",
        "Interpretation**: So viel Extra‑Bestand, um 95% der Nachfrageschwankungen im L‑Horizont zu puffern"
      ]
    },
    {
      "type": "example",
      "subtype": "worked",
      "title": "Worked – Forecast‑Kombination",
      "text": "Drei Modelle liefern ̂y=[105, 110, 100] mit MAE=[8, 6, 10]. **Gewichte ∝ 1/MAE** → w∝[0,125, 0,166, 0,1] → normiert w≈[0,30, 0,40, 0,30].  \nKombi‑Forecast = 0,30·105 + 0,40·110 + 0,30·100 = **106,5**.",
      "steps": [
        "Drei Modelle liefern ̂y=[105, 110, 100] mit MAE=[8, 6, 10]. **Gewichte ∝ 1/MAE** → w∝[0,125, 0,166, 0,1] → normiert w≈[0,30, 0,40, 0,30]",
        "Kombi‑Forecast = 0,30·105 + 0,40·110 + 0,30·100 = **106,"
      ]
    },
    {
      "type": "example",
      "subtype": "fading",
      "title": "Fading – Hierarchie‑Reconciliation",
      "text": "SKU‑Forecasts summieren zu 990, Kategorie‑Ziel 1,000. a) Was tun? b) Warum nicht einfach proportional skalieren?",
      "solution": [
        "Reconciliation: adjustiere SKU‑Forecasts konsistent zur Kategorie.",
        "Proportional ok als Start, aber Qualität der SKU‑Modelle berücksichtigen."
      ]
    },
    {
      "type": "exercises",
      "mini": [
        {
          "prompt": "Servicelevel 97,5% → z≈?",
          "hint": "1,96",
          "solution": "aus Normalverteilung",
          "check": {
            "type": "approx",
            "expected": 1.96,
            "tolerance": 0.05,
            "expr": "1.96"
          },
          "difficulty": "leicht"
        },
        {
          "prompt": "Welches Maß für Kombigewichte robust gegen Ausreißer?",
          "hint": "1/MAE statt 1/RMSE",
          "solution": "MAE robuster",
          "check": {
            "type": "string_contains",
            "expected": "MAE"
          },
          "difficulty": "leicht"
        },
        {
          "prompt": "Tracking‑Signal hoch positiv →",
          "hint": "Unterprognose (Forecast zu niedrig)",
          "solution": "Bias prüfen",
          "check": {
            "type": "string_contains",
            "expected": "Unter"
          },
          "difficulty": "leicht"
        },
        {
          "prompt": "Nenne Beziehung zwischen Varianz und Standardabweichung (Textantwort).",
          "solution": "σ = √Varianz",
          "check": {
            "type": "string_contains",
            "expected": "√"
          },
          "covers_outcomes": [
            0
          ],
          "difficulty": "leicht"
        },
        {
          "prompt": "Nenne Beziehung zwischen Varianz und Standardabweichung (Textantwort).",
          "solution": "σ = √Varianz",
          "check": {
            "type": "string_contains",
            "expected": "√"
          },
          "covers_outcomes": [
            1
          ],
          "difficulty": "leicht"
        },
        {
          "prompt": "Nenne Beziehung zwischen Varianz und Standardabweichung (Textantwort).",
          "solution": "σ = √Varianz",
          "check": {
            "type": "string_contains",
            "expected": "√"
          },
          "covers_outcomes": [
            2
          ],
          "difficulty": "leicht"
        }
      ],
      "long": [
        {
          "title": "Praxis – Budgetrollierung mit Intervallen",
          "context": "Quartalsumsätze; du hast Punkt‑Forecasts und RMSE‑basierte Intervalle. Management will ‚Spannbreite‘ und Risiken.",
          "subtasks": [
            {
              "text": "Baue 80/95‑Intervalle aus RMSE."
            },
            {
              "text": "Diskutiere, was bei multiplikativer Saison mit log‑Skala zu beachten ist."
            },
            {
              "text": "Leite Impact auf EBIT bei DB‑Rate 35% ab."
            }
          ],
          "hints": [
            "±1,28σ/±1,96σ.",
            "Log‑Intervalle asymmetrisch → zurücktransformieren.",
            "ΔEBIT≈0,35·ΔUmsatz."
          ],
          "solutions": [
            "Intervalle angegeben",
            "Skalenhinweis gemacht",
            "EBIT‑Ableitung ok"
          ],
          "checks": [
            {
              "type": "free_form",
              "keywords": [
                "Intervalle",
                "EBIT",
                "log"
              ]
            }
          ],
          "difficulty": "leicht",
          "steps": [
            "Intervalle angegeben",
            "Skalenhinweis gemacht",
            "EBIT‑Ableitung ok"
          ]
        }
      ]
    },
    {
      "type": "common_mistakes",
      "items": [
        "Sicherheitsbestand aus Mittelwert statt Fehlerstreuung berechnet.",
        "Hierarchie‑Inkonsistenzen ignoriert (SKU ≠ Summe Kategorie).",
        "Gewichte für Kombination ohne Validierung (keine Backtest‑Fehler)."
      ]
    },
    {
      "type": "quiz",
      "items": [
        {
          "type": "single_choice",
          "question": "Formel für Sicherheitsbestand (vereinfachtes Modell):",
          "options": [
            "z·σ_L",
            "z/σ_L",
            "σ_L/z"
          ],
          "answer_index": 0,
          "rationale": "Servicefaktor × Streuung.",
          "difficulty": "mittel",
          "feedback_correct": "Richtig. Servicefaktor × Streuung.",
          "feedback_incorrect": "Beachte: σ = √Varianz; Median robuster als Mittelwert."
        },
        {
          "type": "true_false",
          "question": "Kombinierte Forecasts sind oft robuster als Einzelmodelle.",
          "answer": true,
          "rationale": "Diversifikation.",
          "difficulty": "leicht",
          "feedback_correct": "Richtig. Diversifikation.",
          "feedback_incorrect": "Beachte: σ = √Varianz; Median robuster als Mittelwert."
        },
        {
          "type": "single_choice",
          "question": "Tracking‑Signal überwacht primär…",
          "options": [
            "Bias",
            "Varianz",
            "Saison"
          ],
          "answer_index": 0,
          "rationale": "Systematik.",
          "difficulty": "leicht",
          "feedback_correct": "Richtig. Systematik.",
          "feedback_incorrect": "Beachte: σ = √Varianz; Median robuster als Mittelwert."
        },
        {
          "type": "true_false",
          "question": "Die Standardabweichung ist die Wurzel aus der Varianz.",
          "answer": true,
          "rationale": "σ = √Varianz.",
          "covers_outcomes": [
            0
          ],
          "difficulty": "leicht",
          "feedback_correct": "Richtig. σ = √Varianz.",
          "feedback_incorrect": "Beachte: σ = √Varianz; Median robuster als Mittelwert."
        },
        {
          "type": "true_false",
          "question": "Der Median ist robuster gegenüber Ausreißern als der Mittelwert.",
          "answer": true,
          "rationale": "Median reagiert weniger auf Extremwerte.",
          "covers_outcomes": [
            1
          ],
          "difficulty": "leicht",
          "feedback_correct": "Richtig. Median reagiert weniger auf Extremwerte.",
          "feedback_incorrect": "Beachte: σ = √Varianz; Median robuster als Mittelwert."
        },
        {
          "type": "true_false",
          "question": "Die Standardabweichung ist die Wurzel aus der Varianz.",
          "answer": true,
          "rationale": "σ = √Varianz.",
          "covers_outcomes": [
            2
          ],
          "difficulty": "leicht",
          "feedback_correct": "Richtig. σ = √Varianz.",
          "feedback_incorrect": "Beachte: σ = √Varianz; Median robuster als Mittelwert."
        }
      ]
    },
    {
      "type": "summary",
      "text": "Du setzt Forecasts operativ ein: Bestände, Budgets, Kombinationen und Hierarchien sauber aufsetzen."
    },
    {
      "type": "outlook",
      "text": "Optionales Folgemodul: **Zeitreihen V – ARIMA/ETS & Ursachen‑Modelle** (ARIMA, Regression mit Feiertagen, Promo‑Effekte)."
    }
  ],
  "reading_time_band": "gründlich"
}
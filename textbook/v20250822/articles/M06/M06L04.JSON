{
  "id": "M06L04",
  "title": "Lehrtext – Grundlagen: Lineare Optimierung IV – Anwendungen: Transport, Zuordnung, Blending & Produktionsplanung (Gleichungen)",
  "reading_time_min": 92,
  "prerequisites": [
    "M06L03"
  ],
  "outcomes": [
    {
      "level": "Apply",
      "text": "Transport‑/Zuordnungs‑/Blending‑/Produktionsplanungs‑LPs modellieren."
    },
    {
      "level": "Analyze",
      "text": "Modellierungsentscheidungen begründen (Indices, Balancegleichungen, Einheiten, zeitliche Kopplungen)."
    },
    {
      "level": "Evaluate",
      "text": "Lösungen wirtschaftlich interpretieren (Schattenpreise, reduzierte Kosten, Kapazitätsauslastung)."
    },
    {
      "level": "Understand",
      "text": "Grenzen linearer Modelle kennen (Ganzzahlbedarf, Setup‑Kosten, Fix/Step‑Kosten)."
    }
  ],
  "blocks": [
    {
      "type": "introduction",
      "text": "Wir übertragen LP‑Techniken auf typische **Controlling‑/Operations‑Fälle**: **Transport**, **Zuordnung**, **Blending (Mischung)**,\n**Produktionsplanung über Perioden**. Du erhältst Modell‑Schablonen, Worked‑Examples und Fading‑Aufgaben."
    },
    {
      "type": "concept",
      "title": "Index‑Modellierung (Schema)",
      "text": "- Transport: x_{i,j} = Menge von Werk i zu Kunde j.  \n  Zielfunktion: min Σ c_{i,j} x_{i,j}; Nebenbedingungen: Σ_j x_{i,j} ≤ Angebot_i; Σ_i x_{i,j} ≥ Nachfrage_j; x≥0.\n- Zuordnung (Assignment): Spezialfall mit Σ_j x_{i,j}=1 und Σ_i x_{i,j}=1; oft 0/1‑Variablen (IP).\n- Blending: min Kosten bei Qualitätsgrenzen: Σ a_{k,i} x_i ≥/≤ Q_k; Σ x_i = Gesamtmenge.\n- Produktionsplanung (mehrperiodig): x_t Produktion, I_t Lager; I_t = I_{t-1} + x_t − Nachfrage_t; Kapazität x_t ≤ Kap_t; min Σ(Prod+Lagerkosten).",
      "explanation": "\n\n**Decision-Hints:**\n- Lineare Gleichungen isolieren: gleiche Operation auf beiden Seiten.\n- Klammern zuerst auflösen, dann nach x umstellen."
    },
    {
      "type": "visual",
      "title": "ASCII – Transportnetz",
      "ascii": "Werke i=1..m  ──►  Kunden j=1..n\n   \\  x_ij  /\n    \\______/    Kosten c_ij pro Einheit",
      "caption": "Flüsse x_{i,j} mit Angebots‑ und Nachfragerestriktionen.",
      "alt_text": "ASCII-Visual: Flüsse x_{i,j} mit Angebots‑ und Nachfragerestriktionen. — Achsen x/y, Einheiten und Legende beachten."
    },
    {
      "type": "example",
      "subtype": "worked",
      "title": "Worked – Transport (Kostenminimierung)",
      "text": "2 Werke (Angebot 40/30), 3 Kunden (Nachfrage 20/25/25), Kosten c_{i,j} in €/Stück:  \nWerk1→(K1=2, K2=3, K3=1); Werk2→(K1=3, K2=1, K3=2).  \nModell: min Σ c_{i,j}x_{i,j} s.t. Angebots‑ & Nachfragegleichungen; x≥0.  \nEine optimale Basis: x_{1,3}=25, x_{1,1}=15, x_{2,2}=25, x_{2,1}=5 (andere 0).  \nGesamtkosten = 25·1 + 15·2 + 25·1 + 5·3 = **€ 95**.",
      "steps": [
        "Werke (Angebot 40/30), 3 Kunden (Nachfrage 20/25/25), Kosten c_{i,j} in €/Stück:",
        "Werk1→(K1=2, K2=3, K3=1); Werk2→(K1=3, K2=1, K3=",
        "Modell: min Σ c_{i,j}x_{i,j} s.t. Angebots‑ & Nachfragegleichungen; x≥",
        "Eine optimale Basis: x_{1,3}=25, x_{1,1}=15, x_{2,2}=25, x_{2,1}=5 (andere",
        "Gesamtkosten = 25·1 + 15·2 + 25·1 + 5·3 = **€"
      ]
    },
    {
      "type": "example",
      "subtype": "worked",
      "title": "Worked – Produktionsplanung (2 Perioden)",
      "text": "Nachfrage D₁=100, D₂=120; Kapazität K₁=110, K₂=110; Prod‑Kosten € 5/Stk., Lager € 0,5/Stk./Periode.  \nVariablen: x₁,x₂ Produktion; I₁,I₂ Lager (I₂ Endbestand optional).  \nI₁ = x₁ − D₁; I₂ = I₁ + x₂ − D₂; 0 ≤ x_t ≤ K_t; I_t ≥ 0.  \nZiel: min 5(x₁+x₂) + 0,5·I₁ (I₂=0). **Lösung**: x₁=110 → I₁=10; x₂=110 → I₂=0; Kosten=5·220+0,5·10=**€ 1,105**.",
      "steps": [
        "Nachfrage D₁=100, D₂=120; Kapazität K₁=110, K₂=110; Prod‑Kosten € 5/Stk., Lager € 0,5/Stk./Periode",
        "Variablen: x₁,x₂ Produktion; I₁,I₂ Lager (I₂ Endbestand optional",
        "I₁ = x₁ − D₁; I₂ = I₁ + x₂ − D₂; 0 ≤ x_t ≤ K_t; I_t ≥",
        "Ziel: min 5(x₁+x₂) + 0,5·I₁ (I₂=0). **Lösung**: x₁=110 → I₁=10; x₂=110 → I₂=0; Kosten=5·220+0,5·10=**€ 1,"
      ]
    },
    {
      "type": "example",
      "subtype": "fading",
      "title": "Fading – Blending",
      "text": "Zwei Rohstoffe R1,R2 mit Kosten € 3/kg und € 5/kg. Mischung 100 kg mit mind. 20% Bestandteil A.  \nA‑Anteil: R1 hat 10%, R2 40%. Variablen x₁,x₂; Σ x=100; 0,10x₁+0,40x₂ ≥ 20 → __  \nZiel min 3x₁+5x₂; x≥0. Finde günstige Mischung.",
      "solution": [
        "0,10x₁+0,40x₂ ≥ 20 ⇒ x₂ ≥ (20−0,10x₁)/0,40",
        "Kosten sinken mit mehr x₁, aber Qualitätsgrenze setzt Untergrenze für x₂. Ecklösung bei Bindung."
      ],
      "steps": [
        "Zwei Rohstoffe R1,R2 mit Kosten € 3/kg und € 5/kg. Mischung 100 kg mit mind. 20% Bestandteil A",
        "A‑Anteil: R1 hat 10%, R2 40%. Variablen x₁,x₂; Σ x=100; 0,10x₁+0,40x₂ ≥ 20 → __",
        "Ziel min 3x₁+5x₂; x≥0. Finde günstige Mischung"
      ]
    },
    {
      "type": "exercises",
      "mini": [
        {
          "prompt": "Transport: Summenbedingungen heißen…",
          "hint": "Angebot/Nachfrage",
          "solution": "Balance",
          "check": {
            "type": "string_contains",
            "expected": "Angebot"
          },
          "difficulty": "leicht"
        },
        {
          "prompt": "Zuordnung: Zeilen/Spalten‑Summe…",
          "hint": "=1",
          "solution": "jede Aufgabe genau einer Ressource",
          "check": {
            "type": "string_contains",
            "expected": "=1"
          },
          "difficulty": "leicht"
        },
        {
          "prompt": "Produktionsplanung: Lagergleichung",
          "hint": "I_t = I_{t-1} + x_t − D_t",
          "solution": "Flow‑Balance",
          "check": {
            "type": "string_contains",
            "expected": "I_t"
          },
          "difficulty": "leicht"
        },
        {
          "prompt": "Nenne den Grundsatz zum Lösen linearer Gleichungen (Textantwort).",
          "solution": "Äquivalenzumformungen: gleiche Operation auf beiden Seiten",
          "check": {
            "type": "string_contains",
            "expected": "Operation"
          },
          "covers_outcomes": [
            0
          ],
          "difficulty": "leicht"
        },
        {
          "prompt": "Nenne den Grundsatz zum Lösen linearer Gleichungen (Textantwort).",
          "solution": "Äquivalenzumformungen: gleiche Operation auf beiden Seiten",
          "check": {
            "type": "string_contains",
            "expected": "Operation"
          },
          "covers_outcomes": [
            1
          ],
          "difficulty": "leicht"
        },
        {
          "prompt": "Nenne den Grundsatz zum Lösen linearer Gleichungen (Textantwort).",
          "solution": "Äquivalenzumformungen: gleiche Operation auf beiden Seiten",
          "check": {
            "type": "string_contains",
            "expected": "Operation"
          },
          "covers_outcomes": [
            2
          ],
          "difficulty": "leicht"
        },
        {
          "prompt": "Nenne den Grundsatz zum Lösen linearer Gleichungen (Textantwort).",
          "solution": "Äquivalenzumformungen: gleiche Operation auf beiden Seiten",
          "check": {
            "type": "string_contains",
            "expected": "Operation"
          },
          "covers_outcomes": [
            3
          ],
          "difficulty": "leicht"
        }
      ],
      "long": [
        {
          "title": "Praxis – 3‑Perioden‑Planung",
          "context": "D=[120,130,140]; K=[130,120,130]; Prod‑Kosten € 6/Stk., Lager € 0,4/Stk./Periode, Startlager 0, Endlager 0.",
          "subtasks": [
            {
              "text": "Formuliere LP mit x₁..x₃, I₁..I₃."
            },
            {
              "text": "Setze Zielfunktion."
            },
            {
              "text": "Skizziere optimale Struktur (wann lagern?)."
            }
          ],
          "hints": [
            "I₁=x₁−120; I₂=I₁+x₂−130; I₃=I₂+x₃−140=0.",
            "min 6Σx + 0,4(I₁+I₂).",
            "Oft Produktion früh bis Kapazität, Rest später."
          ],
          "solutions": [
            "LP korrekt",
            "Kostenstruktur erklärt",
            "Plan skizziert"
          ],
          "checks": [
            {
              "type": "free_form",
              "keywords": [
                "Bestand",
                "Kapazität",
                "Flow"
              ]
            }
          ],
          "difficulty": "leicht",
          "steps": [
            "LP korrekt",
            "Kostenstruktur erklärt",
            "Plan skizziert"
          ]
        }
      ]
    },
    {
      "type": "common_mistakes",
      "items": [
        "Indices verwechselt (i/j vertauscht).",
        "Balancegleichungen als ≤ statt = geschrieben (bei exakter Nachfrage).",
        "Einheiten nicht konsistent (kg vs. t; €/Stk vs. €/t)."
      ]
    },
    {
      "type": "quiz",
      "items": [
        {
          "type": "single_choice",
          "question": "Transportmodell: Nachfragegleichungen sind üblicherweise…",
          "options": [
            "≤",
            "≥",
            "="
          ],
          "answer_index": 2,
          "rationale": "Exakte Bedarfsdeckung (oder ≥ bei Mindestbedarfen).",
          "difficulty": "leicht",
          "feedback_correct": "Richtig. Exakte Bedarfsdeckung (oder ≥ bei Mindestbedarfen).",
          "feedback_incorrect": "Beachte: Äquivalenzumformungen: gleiche Operation beidseitig; Punkt-vor-Strich beachten."
        },
        {
          "type": "true_false",
          "question": "Zuordnungsproblem benötigt oft 0/1‑Variablen.",
          "answer": true,
          "rationale": "Ganzzahligkeit.",
          "difficulty": "leicht",
          "feedback_correct": "Richtig. Ganzzahligkeit.",
          "feedback_incorrect": "Beachte: Äquivalenzumformungen: gleiche Operation beidseitig; Punkt-vor-Strich beachten."
        },
        {
          "type": "single_choice",
          "question": "Mehrperiodenplanung: Lagerkosten…",
          "options": [
            "fördern Vorproduktion",
            "bestrafen Vorproduktion",
            "ohne Einfluss"
          ],
          "answer_index": 1,
          "rationale": "Trade‑off.",
          "difficulty": "leicht",
          "feedback_correct": "Richtig. Trade‑off.",
          "feedback_incorrect": "Beachte: Äquivalenzumformungen: gleiche Operation beidseitig; Punkt-vor-Strich beachten."
        },
        {
          "type": "true_false",
          "question": "Lineare Gleichungen löst man durch dieselbe Operation auf beiden Seiten.",
          "answer": true,
          "rationale": "Äquivalenzumformungen: gleicher Schritt links und rechts.",
          "covers_outcomes": [
            0
          ],
          "difficulty": "leicht",
          "feedback_correct": "Richtig. Äquivalenzumformungen: gleicher Schritt links und rechts.",
          "feedback_incorrect": "Beachte: Äquivalenzumformungen: gleiche Operation beidseitig; Punkt-vor-Strich beachten."
        },
        {
          "type": "true_false",
          "question": "Beim Umstellen kommt die Punkt-vor-Strich-Regel nicht zum Tragen.",
          "answer": false,
          "rationale": "Zuerst Klammern auflösen, Punkt-vor-Strich beachten.",
          "covers_outcomes": [
            1
          ],
          "difficulty": "leicht",
          "feedback_correct": "Richtig. Zuerst Klammern auflösen, Punkt-vor-Strich beachten.",
          "feedback_incorrect": "Beachte: Äquivalenzumformungen: gleiche Operation beidseitig; Punkt-vor-Strich beachten."
        },
        {
          "type": "true_false",
          "question": "Lineare Gleichungen löst man durch dieselbe Operation auf beiden Seiten.",
          "answer": true,
          "rationale": "Äquivalenzumformungen: gleicher Schritt links und rechts.",
          "covers_outcomes": [
            2
          ],
          "difficulty": "leicht",
          "feedback_correct": "Richtig. Äquivalenzumformungen: gleicher Schritt links und rechts.",
          "feedback_incorrect": "Beachte: Äquivalenzumformungen: gleiche Operation beidseitig; Punkt-vor-Strich beachten."
        },
        {
          "type": "true_false",
          "question": "Beim Umstellen kommt die Punkt-vor-Strich-Regel nicht zum Tragen.",
          "answer": false,
          "rationale": "Zuerst Klammern auflösen, Punkt-vor-Strich beachten.",
          "covers_outcomes": [
            3
          ],
          "difficulty": "leicht",
          "feedback_correct": "Richtig. Zuerst Klammern auflösen, Punkt-vor-Strich beachten.",
          "feedback_incorrect": "Beachte: Äquivalenzumformungen: gleiche Operation beidseitig; Punkt-vor-Strich beachten."
        }
      ]
    },
    {
      "type": "summary",
      "text": "Du modellierst Transport, Zuordnung, Blending und Mehrperioden‑Produktion und interpretierst Lösungen ökonomisch."
    },
    {
      "type": "outlook",
      "text": "Optionales Folgemodul: **Ganzzahlige Optimierung & Heuristiken** (Binärvariablen, Losgrößen, Setup‑Kosten)."
    }
  ],
  "reading_time_band": "gründlich"
}